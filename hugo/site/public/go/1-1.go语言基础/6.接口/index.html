<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.96.0" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>6.接口 &middot; Blog</title>
  <meta name="description" content="" />

  
  <link type="text/css" rel="stylesheet" href="/public/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="/public/css/poole.css">
  <link type="text/css" rel="stylesheet" href="/public/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="/public/css/hyde.css">
  <link type="text/css" rel="stylesheet" href="/public/css/bootstrap-iso.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  
</head>

  <body style="background-color: #e8e8e8;">
	<div class="bootstrap-iso">
		<div class="container-fluid">
			<div class="row">
				
				<div class="col-md-2">
					
				</div>
				
				<div class="col-md-8">
					<nav class="navbar navbar-default  nav-stacked" role="navigation">
					    <div class="container-fluid">
							<div class="navbar-header">
								<button type="button" class="navbar-toggle" data-toggle="collapse"
										data-target="#example-navbar-collapse">
									<span class="sr-only">切换导航</span>
									<span class="icon-bar"></span>
									<span class="icon-bar"></span>
									<span class="icon-bar"></span>
								</button>
								<a class="navbar-brand" href="/">Home</a>
							</div>
							<div class="collapse navbar-collapse" id="example-navbar-collapse">
								<ul class="nav navbar-nav">
									<li id="hot"><a href="/hot">资讯</a></li>
									<li id="tool"><a href="/tool">导航</a></li>
									<li id="public"><a href="/public">随笔</a></li>
									<li><a href="#">关于</a></li>
								</ul>
								<i class="navbar-text navbar-right" style="color: #AC2925;"><b>The winner takes it all.</b></i>
							</div>
							
					    </div>
					</nav>
				</div>
				
				<div class="col-md-2">
					
				</div>
				
			</div>
		</div>
	</div>
	
	<div class="theme-base-08 ">
		
		<main class="content container">
		<div class="post">
  <h1>6.接口</h1>
  <time datetime=2022-05-06T10:26:00&#43;0800 class="post-date">Fri, May 6, 2022</time>
  <h3 id="接口概念">接口概念</h3>
<ol>
<li>变量：变量包含值、类型</li>
<li>实例：实例包含值、类型、方法</li>
<li>接口：接口包含值、类型（静态类型、动态类型）、动态类型绑定的方法</li>
<li>接口静态类型：在接口定义时确定，静态类型的本质就是接口的方法签名集合</li>
<li>接口动态类型：接口绑定的具体实例类型为接口的动态类型</li>
<li>接口初始化：为接口绑定具体类型的实例，有两种方式：将具体类型实例赋值给接口、将接口直接赋值给接口</li>
<li>接口方法调用：间接调用所绑定实例的方法</li>
</ol>
<h3 id="底层实现">底层实现</h3>
<p>接口调用分析：</p>
<ol>
<li>接口实例化，即iface数据结构的初始化过程</li>
<li>间接调用实例的方法</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// src/runtime/runtime2.go
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 空接口表示
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">eface</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">_type</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">_type</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">data</span>  <span style="color:#a6e22e">unsafe</span>.<span style="color:#a6e22e">Pointer</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 非空接口表示
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">iface</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">tab</span>  <span style="color:#f92672">*</span><span style="color:#a6e22e">itab</span>					<span style="color:#75715e">// 静态类型、动态类型、方法
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">data</span> <span style="color:#a6e22e">unsafe</span>.<span style="color:#a6e22e">Pointer</span>  		<span style="color:#75715e">// 动态类型的值
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 类型信息
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">itab</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">inter</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">interfacetype</span>		<span style="color:#75715e">// 静态类型
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">_type</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">_type</span>				<span style="color:#75715e">// 动态类型
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">hash</span>  <span style="color:#66d9ef">uint32</span> <span style="color:#75715e">// copy of _type.hash. Used for type switches.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">_</span>     [<span style="color:#ae81ff">4</span>]<span style="color:#66d9ef">byte</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">fun</span>   [<span style="color:#ae81ff">1</span>]<span style="color:#66d9ef">uintptr</span> <span style="color:#75715e">// variable sized. fun[0]==0 means _type does not implement inter. // 方法
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 静态类型信息
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">interfacetype</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">typ</span>     <span style="color:#a6e22e">_type</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">pkgpath</span> <span style="color:#a6e22e">name</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">mhdr</span>    []<span style="color:#a6e22e">imethod</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 动态类型信息
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">_type</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">size</span>       <span style="color:#66d9ef">uintptr</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ptrdata</span>    <span style="color:#66d9ef">uintptr</span> <span style="color:#75715e">// size of memory prefix holding all pointers
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">hash</span>       <span style="color:#66d9ef">uint32</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">tflag</span>      <span style="color:#a6e22e">tflag</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">align</span>      <span style="color:#66d9ef">uint8</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">fieldAlign</span> <span style="color:#66d9ef">uint8</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">kind</span>       <span style="color:#66d9ef">uint8</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// function for comparing objects of this type
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#75715e">// (ptr to object A, ptr to object B) -&gt; ==?
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">equal</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">unsafe</span>.<span style="color:#a6e22e">Pointer</span>, <span style="color:#a6e22e">unsafe</span>.<span style="color:#a6e22e">Pointer</span>) <span style="color:#66d9ef">bool</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// gcdata stores the GC type data for the garbage collector.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#75715e">// If the KindGCProg bit is set in kind, gcdata is a GC program.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#75715e">// Otherwise it is a ptrmask bitmap. See mbitmap.go for details.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">gcdata</span>    <span style="color:#f92672">*</span><span style="color:#66d9ef">byte</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">str</span>       <span style="color:#a6e22e">nameOff</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ptrToThis</span> <span style="color:#a6e22e">typeOff</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="接口断言">接口断言</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">sli</span> <span style="color:#f92672">:=</span> []<span style="color:#66d9ef">int</span>{<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#66d9ef">interface</span>{} = <span style="color:#a6e22e">sli</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 方式一：若断言失败，则panic
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#75715e">//v := i.([]int)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#75715e">//fmt.Printf(&#34;值：%v 类型：%T\n&#34;, v, v)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 方式二：通过返回值，处理断言失败
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">v</span>,<span style="color:#a6e22e">ok</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">i</span>.([]<span style="color:#66d9ef">int</span>); <span style="color:#a6e22e">ok</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;值：%v 类型：%T\n&#34;</span>, <span style="color:#a6e22e">v</span>, <span style="color:#a6e22e">v</span>)
</span></span><span style="display:flex;"><span>	}<span style="color:#66d9ef">else</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;断言失败！&#34;</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 方式三：判断多个接口类型
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">switch</span> <span style="color:#a6e22e">v</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">i</span>.(<span style="color:#66d9ef">type</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">case</span> []<span style="color:#66d9ef">int</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;值：%v 类型：%T\n&#34;</span>, <span style="color:#a6e22e">v</span>, <span style="color:#a6e22e">v</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">case</span> []<span style="color:#66d9ef">int32</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;值：%v 类型：%T\n&#34;</span>, <span style="color:#a6e22e">v</span>, <span style="color:#a6e22e">v</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">default</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;未知类型！&#34;</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="自动检测接口实现">自动检测接口实现</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// 两种方式用于检测myWriter类型是否实现了io.Writer接口，否则编译器报错
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> <span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">Writer</span> = (<span style="color:#f92672">*</span><span style="color:#a6e22e">myWriter</span>)(<span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> <span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">Writer</span> = <span style="color:#a6e22e">myWriter</span>{}
</span></span></code></pre></div><h3 id="值方法和指针方法的区别">值方法和指针方法的区别</h3>
<ol>
<li>值方法无法修改对象本身，指针方法可以修改</li>
<li>值对象和指针对象都可以调用值方法或指针方法</li>
<li>值方法会自动生成指针方法，而指针方法不会自动生成值方法；所以：指针对象实现了所有值方法和指针方法，可以赋值给接口</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">animal</span> <span style="color:#66d9ef">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">sayHello</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">sayWorld</span>()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Cat</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Cat</span>)<span style="color:#a6e22e">sayHello</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">name</span>, <span style="color:#e6db74">&#34;cat say hello&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">c</span> <span style="color:#a6e22e">Cat</span>)<span style="color:#a6e22e">sayWorld</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">name</span>, <span style="color:#e6db74">&#34;cat say world&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 值对象和指针对象都可以调用值方法或指针方法
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">c1</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Cat</span>{<span style="color:#e6db74">&#34;white&#34;</span>}
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">c1</span>.<span style="color:#a6e22e">sayHello</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">c1</span>.<span style="color:#a6e22e">sayWorld</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 值对象和指针对象都可以调用值方法或指针方法
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">c2</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Cat</span>{<span style="color:#e6db74">&#34;black&#34;</span>}
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">c2</span>.<span style="color:#a6e22e">sayHello</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">c2</span>.<span style="color:#a6e22e">sayWorld</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 值方法会自动生成指针方法，而指针方法不会自动生成值方法；所以：指针对象实现了所有值方法和指针方法，可以赋值给接口
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ani</span> <span style="color:#a6e22e">animal</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//ani = c1		//报错：值对象没有实现指针方法：sayHello()
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">ani</span> = <span style="color:#a6e22e">c2</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ani</span>.<span style="color:#a6e22e">sayHello</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ani</span>.<span style="color:#a6e22e">sayWorld</span>()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="嵌套">嵌套</h3>
<h4 id="接口嵌套接口">接口嵌套接口</h4>
<p>新接口包含所有嵌套接口的方法集合</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Reader</span> <span style="color:#66d9ef">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Read</span>(<span style="color:#a6e22e">p</span> []<span style="color:#66d9ef">byte</span>) (<span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">err</span> <span style="color:#66d9ef">error</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Writer</span> <span style="color:#66d9ef">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Write</span>(<span style="color:#a6e22e">p</span> []<span style="color:#66d9ef">byte</span>) (<span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">err</span> <span style="color:#66d9ef">error</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ReadWriter</span> <span style="color:#66d9ef">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Reader</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Writer</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;io&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;reflect&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>()  {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">r</span> <span style="color:#f92672">:=</span> (<span style="color:#f92672">*</span><span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">Reader</span>)(<span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">w</span> <span style="color:#f92672">:=</span> (<span style="color:#f92672">*</span><span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">Writer</span>)(<span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">rw</span> <span style="color:#f92672">:=</span> (<span style="color:#f92672">*</span><span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">ReadWriter</span>)(<span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">printMethod</span>(<span style="color:#a6e22e">r</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">printMethod</span>(<span style="color:#a6e22e">w</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">printMethod</span>(<span style="color:#a6e22e">rw</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">printMethod</span>(<span style="color:#a6e22e">cc</span> <span style="color:#66d9ef">interface</span>{})  {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">v</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">reflect</span>.<span style="color:#a6e22e">TypeOf</span>(<span style="color:#a6e22e">cc</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">elemTyp</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">v</span>.<span style="color:#a6e22e">Elem</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;%s方法集合：\n&#34;</span>, <span style="color:#a6e22e">elemTyp</span>.<span style="color:#a6e22e">Name</span>())
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span><span style="color:#f92672">:=</span><span style="color:#ae81ff">0</span>;<span style="color:#a6e22e">i</span>&lt;<span style="color:#a6e22e">elemTyp</span>.<span style="color:#a6e22e">NumMethod</span>();<span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">elemTyp</span>.<span style="color:#a6e22e">Method</span>(<span style="color:#a6e22e">i</span>).<span style="color:#a6e22e">Name</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//Reader方法集合：
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//Read
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//Writer方法集合：
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//Write
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ReadWriter方法集合：
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//Read
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//Write
</span></span></span></code></pre></div><h4 id="结构体嵌套接口">结构体嵌套接口</h4>
<h4 id="结构体嵌套结构体">结构体嵌套结构体</h4>
<h3 id="接口比较">接口比较</h3>
<h4 id="打印方式">打印方式</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// src/runtime/print.go
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">printeface</span>(<span style="color:#a6e22e">e</span> <span style="color:#a6e22e">eface</span>) {
</span></span><span style="display:flex;"><span>	print(<span style="color:#e6db74">&#34;(&#34;</span>, <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">_type</span>, <span style="color:#e6db74">&#34;,&#34;</span>, <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">data</span>, <span style="color:#e6db74">&#34;)&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">printiface</span>(<span style="color:#a6e22e">i</span> <span style="color:#a6e22e">iface</span>) {
</span></span><span style="display:flex;"><span>	print(<span style="color:#e6db74">&#34;(&#34;</span>, <span style="color:#a6e22e">i</span>.<span style="color:#a6e22e">tab</span>, <span style="color:#e6db74">&#34;,&#34;</span>, <span style="color:#a6e22e">i</span>.<span style="color:#a6e22e">data</span>, <span style="color:#e6db74">&#34;)&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="未初始化的空接口与非空接口">未初始化的空接口与非空接口</h4>
<p>未初始化的接口，无论是空接口还是非空接口，都相等，都等于nil</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>()  {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#66d9ef">interface</span>{}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">err</span> <span style="color:#66d9ef">error</span>
</span></span><span style="display:flex;"><span>	println(<span style="color:#a6e22e">i</span>)
</span></span><span style="display:flex;"><span>	println(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>	println(<span style="color:#e6db74">&#34;i == nil:&#34;</span>, <span style="color:#a6e22e">i</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>	println(<span style="color:#e6db74">&#34;err == nil:&#34;</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>	println(<span style="color:#e6db74">&#34;i == err:&#34;</span>, <span style="color:#a6e22e">i</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//(0x0,0x0)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//(0x0,0x0)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//i == nil: true
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//err == nil: true
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//i == err: true
</span></span></span></code></pre></div><h4 id="初始化的空接口与空接口">初始化的空接口与空接口</h4>
<p>若动态类型和动态类型的值都相等，则接口相等</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>()  {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">v1</span> <span style="color:#66d9ef">interface</span>{}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">v2</span> <span style="color:#66d9ef">interface</span>{}
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">v1</span>,<span style="color:#a6e22e">v2</span> = <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>	println(<span style="color:#a6e22e">v1</span>)
</span></span><span style="display:flex;"><span>	println(<span style="color:#a6e22e">v2</span>)
</span></span><span style="display:flex;"><span>	println(<span style="color:#e6db74">&#34;v1 == v2:&#34;</span>, <span style="color:#a6e22e">v1</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">v2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">v1</span>,<span style="color:#a6e22e">v2</span> = <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>	println(<span style="color:#a6e22e">v1</span>)
</span></span><span style="display:flex;"><span>	println(<span style="color:#a6e22e">v2</span>)
</span></span><span style="display:flex;"><span>	println(<span style="color:#e6db74">&#34;v1 == v2:&#34;</span>, <span style="color:#a6e22e">v1</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">v2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">v1</span>,<span style="color:#a6e22e">v2</span> = <span style="color:#ae81ff">10</span>, int64(<span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>	println(<span style="color:#a6e22e">v1</span>)
</span></span><span style="display:flex;"><span>	println(<span style="color:#a6e22e">v2</span>)
</span></span><span style="display:flex;"><span>	println(<span style="color:#e6db74">&#34;v1 == v2:&#34;</span>, <span style="color:#a6e22e">v1</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">v2</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//(0x18f100,0x1ad550)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//(0x18f100,0x1ad558)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//v1 == v2: false
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//(0x18f100,0x1ad550)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//(0x18f100,0x1ad550)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//v1 == v2: true
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//(0x18f100,0x1ad550)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//(0x18f1c0,0x1ad550)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//v1 == v2: false
</span></span></span></code></pre></div><h4 id="初始化的非空接口与非空接口">初始化的非空接口与非空接口</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;errors&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>()  {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">v1</span> <span style="color:#66d9ef">error</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">v2</span> <span style="color:#66d9ef">error</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">v1</span>,<span style="color:#a6e22e">v2</span> = <span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">New</span>(<span style="color:#e6db74">&#34;err1&#34;</span>), <span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">New</span>(<span style="color:#e6db74">&#34;err2&#34;</span>)
</span></span><span style="display:flex;"><span>	println(<span style="color:#a6e22e">v1</span>)
</span></span><span style="display:flex;"><span>	println(<span style="color:#a6e22e">v2</span>)
</span></span><span style="display:flex;"><span>	println(<span style="color:#e6db74">&#34;v1 == v2:&#34;</span>, <span style="color:#a6e22e">v1</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">v2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">v1</span>,<span style="color:#a6e22e">v2</span> = <span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">New</span>(<span style="color:#e6db74">&#34;err1&#34;</span>), <span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">New</span>(<span style="color:#e6db74">&#34;err1&#34;</span>)
</span></span><span style="display:flex;"><span>	println(<span style="color:#a6e22e">v1</span>)
</span></span><span style="display:flex;"><span>	println(<span style="color:#a6e22e">v2</span>)
</span></span><span style="display:flex;"><span>	println(<span style="color:#e6db74">&#34;v1 == v2:&#34;</span>, <span style="color:#a6e22e">v1</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">v2</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//(0x25e688,0xc000045f60)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//(0x25e688,0xc000045f50)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//v1 == v2: false
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//(0x25e688,0xc000045f40)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//(0x25e688,0xc000045f30)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//v1 == v2: false
</span></span></span></code></pre></div><h4 id="初始化的空接口与非空接口">初始化的空接口与非空接口</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">...</span>
</span></span></code></pre></div>
</div>

<h2>Comments</h2>
<div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "spf13" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
		</main>
		
		
		  
		
	</div>
	
  </body>
</html>
